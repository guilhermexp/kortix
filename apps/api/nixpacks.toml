[phases.setup]
# Include both Bun and Python 3.11 with pip
nixPkgs = ["bun", "python311", "python311Packages.pip"]

[phases.install]
cmds = [
    "bun install",
    # Install MarkItDown and its dependencies
    "python3 -m pip install --user --no-cache-dir 'markitdown[all]==0.1.3'"
]

[phases.build]
cmds = ["bun run check-types"]

[start]
cmd = "bun run --cwd apps/api start"

[variables]
# Configure Python to use system Python
MARKITDOWN_PYTHON_PATH = "python3"
