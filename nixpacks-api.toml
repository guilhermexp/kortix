# Nixpacks configuration for API service with Python support

[phases.setup]
# Include Bun and Python 3.11 with pip
nixPkgs = ["bun", "python311", "python311Packages.pip"]

[phases.install]
cmds = [
    "bun install",
    # Install MarkItDown globally
    "python3 -m pip install --no-cache-dir 'markitdown[all]==0.1.3'"
]

[phases.build]
# Build command if needed
cmds = []

[start]
cmd = "cd apps/api && bun run start"

[variables]
# Configure Python to use system Python
MARKITDOWN_PYTHON_PATH = "python3"